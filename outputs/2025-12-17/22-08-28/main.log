[2025-12-17 22:08:31,960][__main__][INFO] - Using device: cuda
[2025-12-17 22:08:31,963][__main__][INFO] - ====================================================================================================
[2025-12-17 22:08:31,963][__main__][INFO] - GENEFORMER PERTURBATION PIPELINE
[2025-12-17 22:08:31,963][__main__][INFO] - ====================================================================================================
[2025-12-17 22:08:31,963][__main__][INFO] - Experiment: geneformer_perturbation
[2025-12-17 22:08:31,969][__main__][INFO] - 
Configuration:
seed: 42
model:
  name: gf-12L-38M-i4096
  batch_size: 128
  max_length: 2048
  device: cuda:0
data:
  pertpy_data_identifier: norman_2019
  condition_filter: control
  gene_names_column: index
  use_raw_counts: false
  preprocess: true
  normalize: true
  filter_genes: true
  min_genes: 200
  min_cells: 3
  max_cells: 1000
  max_genes: 100
perturbation:
  gene_list: null
  num_genes: 10
  perturbation_type: knockout
  selection_method: top_expressed
  perturbation_strength: 2.0
optimization:
  methods:
  - distributed
  - batching
  - quantization
  batching:
    enabled: true
    batch_size_multiplier: 2
  quantization:
    enabled: true
    dtype: qint8
    quantize_layers:
    - torch.nn.Linear
    dynamic: true
  onnx:
    enabled: true
    opset_version: 14
    optimize: true
    use_gpu: true
    precision: FP16
  distributed:
    enabled: true
    backend: nccl
    world_size: null
    use_data_parallel: true
output:
  dir: outputs
  save_outputs: true
  compression: true
  precision: float32
  save_embeddings: true
  save_perturbations: true
  save_metadata: true
  save_cell_ids: true
  save_gene_names: true
  save_detailed_comparisons: true
  log_level: INFO
  log_to_file: true
  log_file: pipeline.log
hardware:
  device: auto
  mixed_precision: true
  cudnn_benchmark: true
  empty_cache_between_methods: true
experiment:
  name: geneformer_perturbation
  tags: []
  notes: ''
reproducibility:
  deterministic: true
advanced:
  compile_model: false
  compile_backend: inductor
  continue_on_error: true
validation:
  min_correlation: 0.95
  max_mse: 0.01
  warn_on_threshold: true
  check_nan: true
  check_inf: true

[2025-12-17 22:08:31,969][__main__][INFO] - Loading Geneformer model...
[2025-12-17 22:08:34,048][helical.models.geneformer.model][INFO] - Model finished initializing.
[2025-12-17 22:08:34,048][helical.models.geneformer.model][INFO] - 'gf-12L-38M-i4096' model is in 'eval' mode, on device 'cuda:0' with embedding mode 'cell'.
[2025-12-17 22:08:34,049][__main__][INFO] - Enabling automatic mixed precision
[2025-12-17 22:08:34,050][__main__][ERROR] - Pipeline failed with error: 'GeneformerPerturbationPipeline' object has no attribute 'check_'
Traceback (most recent call last):
  File "/root/capsule/code/helical-challenge/main.py", line 1211, in main
    pipeline.run()
  File "/root/capsule/code/helical-challenge/main.py", line 1058, in run
    model = self.load_model()
  File "/root/capsule/code/helical-challenge/main.py", line 390, in load_model
    if self.check_:
AttributeError: 'GeneformerPerturbationPipeline' object has no attribute 'check_'
